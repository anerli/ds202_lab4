#idk <- flights %>% select(origin, year, month, day)
dat <- flights %>%
left_join(weather, by=c('origin', 'year', 'month', 'day')) %>%
select(visib, dep_delay, arr_delay)
library(dplyr)
library(ggplot2)
# 1
library(ggplot2)
library(nycflights13)
# 2
Here we can see the origin and destination per flight, including FAA code, name,
latitude and longitude.
# 3
library(dplyr)
library(ggplot2)
library(nycflights13)
daily_flight_counts <- flights %>%
group_by(year, month, day, flight) %>%
summarize(n=n())
greater_than_one_flight_in_a_day <- daily_flight_counts %>%
filter(n > 1)
nrow(greater_than_one_flight_in_a_day) > 0
dat <- flights %>% left_join(airports, by=c('origin'='faa'))
dat <- dat %>%
mutate(origin_lat=lat, origin_lon=lon, origin_name=name) %>%
select(origin, origin_name, origin_lat, origin_lon, dest)
dat <- dat %>% left_join(airports, by=c('dest'='faa'))
dat <- dat %>%
mutate(dest_lat=lat, dest_lon=lon, dest_name=name) %>%
select(origin, origin_name, origin_lat, origin_lon, dest, dest_name, dest_lat, dest_lon)
dat %>% head
dat %>% str
#idk <- flights %>% select(origin, year, month, day)
dat <- flights %>%
left_join(weather, by=c('origin', 'year', 'month', 'day')) %>%
select(visib, dep_delay, arr_delay)
#head(dat, 10)
#str(dat)
#sample_n(dat,10000) %>% ggplot(aes(x=visib, y=dep_delay)) + geom_boxplot()
#dat %>% dat[,1:10]
#dat %>% ggplot(aes(x=visib, y=dep_delay)) + geom_point()
dat %>% group_by(visib) %>% summarize(n=n())
dat <- dat %>% mutate(visib = as.factor(visib))
sample_n(dat,10000) %>% ggplot(aes(x=visib, y=dep_delay)) + geom_boxplot()
dat <- dat %>% mutate(visib = as.factor(visib))
sample_n(dat,10000) %>% ggplot(aes(x=visib, y=dep_delay)) + geom_boxplot()
sample_n(dat,100000) %>% ggplot(aes(x=visib, y=dep_delay)) + geom_boxplot()
sample_n(dat,100000) %>% ggplot(aes(x=visib, y=dep_delay)) + geom_boxplot() +
xlab('Visibility (Miles)') + ylab('Departure Delay')
sample_n(dat,100000) %>% ggplot(aes(x=visib, y=arr_delay)) + geom_boxplot() +
xlab('Visibility (Miles)') + ylab('Arrival Delay')
dat %>% group_by(visib) %>% summarize(avg_dep_delay=mean(dep_delay), avg_arr_delay=mean(arr_delay))
dat %>% group_by(visib) %>%
summarize(avg_dep_delay=mean(dep_delay, na.rm=TRUE), avg_arr_delay=mean(arr_delay, na.rm=TRUE))
dat <- airports %>% left_join(flights)
dat <- airports %>% left_join(flights, by=c('faa'='dest'))
dat
?flights
dat <- airports %>% left_join(flights, by=c('faa'='dest'))
dat
dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30)
dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30) %>%
group_by(severe_delay) %>%
summarize(n = n())
dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30) %>%
group_by(faa, severe_delay) %>%
summarize(n = n())
severse_delay_counts <- dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30) %>%
group_by(faa, severe_delay) %>%
summarize(n = n())
severe_delay_counts
severe_delay_counts <- dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30) %>%
group_by(faa, severe_delay) %>%
summarize(n = n())
severe_delay_counts
severe_delay_counts %>%
mutate(severe_delay_counts,
severity = filter(severe_delay_counts, severe_delay==TRUE) / filter(severse_delay_counts, severe_delay==FALSE)
)
}
for (row in severse_delay_counts) {
}
severe_delay_counts
severe_delays <- filter(severe_delay_counts, severe_delay=TRUE)
nonsevere_delays <- filter(severe_delay_counts, severe_delay=FALSE)
severe_delays
severe_delays <- filter(severe_delay_counts, severe_delay=TRUE)
nonsevere_delays <- filter(severe_delay_counts, severe_delay=FALSE)
severe_delays
severe_delays <- filter(severe_delay_counts, severe_delay==TRUE)
nonsevere_delays <- filter(severe_delay_counts, severe_delay==FALSE)
severe_delays
nonsevere_delays
severe_delays
nonsevere_delays
severe_delays
nonsevere_delays
severe_delays <- filter(severe_delay_counts, severe_delay==TRUE)
nonsevere_delays <- filter(severe_delay_counts, severe_delay==FALSE)
severe_delays
nonsevere_delays
severe_delays
nonsevere_delays <- filter(severe_delay_counts, severe_delay==FALSE)
nonsevere_delays
airports <- airports %>% left_join(severe_delays)
airports <- airports %>% left_join(nonsevere_delays)
airports
severe_delays <- severe_delay_counts %>%
filter(severe_delay==TRUE) %>%
select(n) %>%
mutate(sev_delays=n)
severe_delay_counts <- dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30) %>%
group_by(faa, severe_delay) %>%
summarize(n = n())
severe_delay_counts
severe_delays <- severe_delay_counts %>%
filter(severe_delay==TRUE) %>%
select(n) %>%
mutate(sev_delays=n)
severe_delays
severe_delays <- severe_delay_counts %>%
filter(severe_delay==TRUE) %>%
mutate(sev_count=n) %>%
select(sev_count)
severe_delays
nonsevere_delays <- severe_delay_counts %>%
filter(severe_delay==FALSE) %>%
mutate(nsev_count=n) %>%
select(nsev_count)
severe_delays
nonsevere_delays
airports <- airports %>% left_join(severe_delays)
airports <- airports %>% left_join(nonsevere_delays)
airports
severe_delay_counts
flights %>% filter(faa='ABY')
flights %>% filter(faa=='ABY')
flights %>% filter(origin=='ABY')
flights %>% filter(dest=='ABY')
airports
airports <- airports %>% mutate(delay_severity=sev_count/(sev_count+nsev_count))
airports
no_na <- airports %>% filter(!is.na(delay_severity))
no_na
head(sorted, 5)
no_na <- airports %>% filter(!is.na(delay_severity))
sorted <- no_na %>% arrange(desc(delay_severity))
head(sorted, 5)
reduced <- sorted %>% select(faa, name, delay_severity)
head(reduced, 5)
# Do the same procedure as before but filter down the initial dataset to just June 13, 2013
dat <- airports %>%
filter(day=13, month=6, year=2013) %>%
left_join(flights, by=c('faa'='dest'))
# Do the same procedure as before but filter down the initial dataset to just June 13, 2013
dat <- airports %>%
filter(day==13, month==6, year==2013) %>%
left_join(flights, by=c('faa'='dest'))
# Do the same procedure as before but filter down the flight dataset to just June 13, 2013
june13_flights <- flights %>%
filter(day==13, month==6, year==2013)
dat <- airports %>%
left_join(june13_flights, by=c('faa'='dest'))
severe_delay_counts <- dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30) %>%
group_by(faa, severe_delay) %>%
summarize(n = n())
severe_delays <- severe_delay_counts %>%
filter(severe_delay==TRUE) %>%
mutate(sev_count=n) %>%
select(sev_count)
nonsevere_delays <- severe_delay_counts %>%
filter(severe_delay==FALSE) %>%
mutate(nsev_count=n) %>%
select(nsev_count)
# A lot of airports just don't have any flight data, which is the reason for so many NA's
airports <- airports %>% left_join(severe_delays)
airports <- airports %>% left_join(nonsevere_delays)
airports <- airports %>%
mutate(delay_severity=sev_count/(sev_count+nsev_count)) %>%
select(-sev_count, -nsev_count)
no_na <- airports %>% filter(!is.na(delay_severity))
no_na
sorted <- no_na %>% arrange(desc(delay_severity))
reduced <- sorted %>% select(faa, name, delay_severity)
reduced
flights
june13_flights
dat <- airports %>%
left_join(june13_flights, by=c('faa'='dest'))
severe_delay_counts <- dat %>%
group_by(faa) %>%
summarize(severe_delay=arr_delay>30) %>%
group_by(faa, severe_delay) %>%
summarize(n = n())
severe_delays <- severe_delay_counts %>%
filter(severe_delay==TRUE) %>%
mutate(sev_count=n) %>%
select(sev_count)
nonsevere_delays <- severe_delay_counts %>%
filter(severe_delay==FALSE) %>%
mutate(nsev_count=n) %>%
select(nsev_count)
# A lot of airports just don't have any flight data, which is the reason for so many NA's
airports <- airports %>% left_join(severe_delays)
airports <- airports %>% left_join(nonsevere_delays)
airports <- airports %>%
mutate(delay_severity=sev_count/(sev_count+nsev_count)) %>%
select(-sev_count, -nsev_count)
no_na <- airports %>% filter(!is.na(delay_severity))
sorted <- no_na %>% arrange(desc(delay_severity))
reduced <- sorted %>% select(faa, name, delay_severity)
reduced
mean(reduced$delay_severity)
weather %>% filter(day==13, month==6, year==2013)
weather %>% mean(wind_speed)
weather$wind_speed %>% mean
june13_weather$wind_speed %>% mean
june13_weather <- weather %>% filter(day==13, month==6, year==2013)
weather$wind_speed %>% mean(na.rm=TRUE)
june13_weather$wind_speed %>% mean(na.rm=TRUE)
```{r, results='asis'}
dat <- flights %>%
left_join(weather, by=c('origin', 'year', 'month', 'day')) %>%
select(visib, dep_delay, arr_delay)
dat <- flights %>%
left_join(weather, by=c('origin', 'year', 'month', 'day')) %>%
select(visib, dep_delay, arr_delay)
dat %>% group_by(visib) %>% summarize(n=n())
visib_counts -> print(n=nrow(visib_counts))
visib_counts <- dat %>% group_by(visib) %>% summarize(n=n())
visib_counts -> print(n=nrow(visib_counts))
visib_counts %>% print(n=nrow(visib_counts))
avg_delays_by_visib <- dat %>% group_by(visib) %>%
summarize(avg_dep_delay=mean(dep_delay, na.rm=TRUE), avg_arr_delay=mean(arr_delay, na.rm=TRUE))
head(avg_delays_by_visib, 21)
?pivot_wider
libary(tidyverse)
library(tidyverse)
?pivot_wider
setwd("~/R/ds202_lab4")
defense <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Defense')
str(def)
library(tidyverse)
def <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Defense')
ofn <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Offense')
bio <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Biography')
str(def)
def <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Defense')
library(tidyverse)
def <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Defense')
def <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Defensive')
ofn <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Offensive')
bio <- readxl::read_excel('cyclonesFootball2019.xlsx', sheet='Biography')
str(def)
str(ofn)
str(bio)
head(def)
str(def)
str(ofn)
str(bio)
def <- def %>%
mutate(Name=as.numeric(Name), Opponent_Opponent=as.Numeric(Opponent_Opponent))
def <- def %>%
mutate(Name=as.factor(Name), Opponent_Opponent=as.factor(Opponent_Opponent))
str(def)
ofn <- ofn %>%
mutate(Name=as.factor(Name), Opponent_Opponent=as.factor(Opponent_Opponent))
str(ofn)
str(bio)
bio <- bio %>%
mutate(Name=as.factor(Name))
str(bio)
str(def)
str(ofn)
?across
# Make statistics numerical
def <- def %>%
mutate(across(Rushing_ATT:Passing_INT, as.numeric))
# Make statistics numerical
def <- def %>%
mutate(across(Tackles_Solo:Pass_PB, as.numeric))
str(def)
ofn <- ofn %>%
mutate(across(Rushing_ATT:Passing_INT, as.numeric))
str(ofn)
str(bio)
bio <- bio %>%
separate(Height, into=c('HeightFeet', 'HeightInches'), sep='-') %>%
mutate(across(c(HeightFeet, HeightInches)), as.numeric) %>%
mutate(Height=12*HeightFeet + HeighInches) %>%
select(-HeightFeet, -HeightInches)
bio <- bio %>%
separate(Height, into=c('HeightFeet', 'HeightInches'), sep='-') %>%
mutate(across(c(HeightFeet, HeightInches), as.numeric)) %>%
mutate(Height=12*HeightFeet + HeighInches) %>%
select(-HeightFeet, -HeightInches)
bio <- bio %>%
separate(Height, into=c('HeightFeet', 'HeightInches'), sep='-') %>%
mutate(across(c(HeightFeet, HeightInches), as.numeric)) %>%
mutate(Height=12*HeightFeet + HeightInches) %>%
select(-HeightFeet, -HeightInches)
# Now height is just in inches
str(bio)
ofn
str(ofn)
?pivot_longer
